!function(t) {
  function e(e) {
    var i = t(e.currentTarget).val();
    if (console.log(i), i.length > 0) {
      t("#common-packages").hide();
      var l = _.filter(s, function(t) {
        return new RegExp(i, "i").test(t[1])
      });
      i.length < 2 && (l = _.slice(l, 0, 100));
      var o = l.reduce(function(t, e) {
        return t.push(a.replace(/{{file}}/g, _.escape(e[0])).replace(/{{name}}/g, _.escape(e[1])).replace(/{{description}}/g, _.escape(e[2])).replace(/{{stars}}/g, _.escape(e[3]))), t
      }, []).join("");
      t("#search-results").html(o).show()
    } else t("#common-packages").show(), t("#search-results").hide()
  }
  var a = '<a href="/doc-{{file}}.html" class="package list-group-item" target="_blank"  onclick="_hmt.push([\'_trackEvent\', \'packages\', \'click\', \'{{file}}.html\'])"><div class="row"><div class="col-md-3"><h4 class="package-name">{{name}}</h4></div><div class="col-md-9 hidden-xs"><p class="package-description">{{description}}</p></div><div class="package-extra-info col-md-9 col-md-offset-3 col-xs-12"><span><i class="fa fa-star"></i> {{stars}}</span></div></div></a>',
    s = [];
  t(".search").length > 0 && t.get("./libraries.json?" + build).done(function(t) {
    s = t
  }), t(".search").val("").focus(), t(".search").on("input propertychange", _.throttle(e, 60)), t(document).on("input", ".clearable", function() {
    this.value ? t(this).next("i").removeClass("fa-search").addClass("fa-close x") : t(this).next("i").removeClass("fa-close").addClass("fa-search")
  }).on("mousemove", ".x", function(e) {
    t(this).addClass("onX")
  }).on("click", ".onX", function() {
    t(this).removeClass("x onX").prev("input").val("").change(), t(this).removeClass("fa-close").addClass("fa-search"), t("#common-packages").show(), t("#search-results").hide()
  }), t(window).scroll(function() {
    t(this).scrollTop() > 100 ? t("#back-to-top").fadeIn() : t("#back-to-top").fadeOut()
  }), t("#back-to-top").on("click", function(e) {
    return e.preventDefault(), t("html, body").animate({
      scrollTop: 0
    }, 100), !1
  });
  try {
    if ("/" !== window.location.pathname) {
      var i = t(".site-header h1").first().text();
      t(".site-header").geopattern(i)
    }
  } catch (t) {
    console.log(t)
  }
  t(".btn-group .btn").click(function() {
    var e = t("input", this),
      a = e.attr("id");
    console.log("Protocal ", a, " was selected"), "relative" === a ? t(".library-url").each(function() {
      var e = t(this).text();
      t(this).text(e.replace(/^https?:/i, "")), t(this).parent().removeClass("js-https")
    }) : "http" === a ? t(".library-url").each(function() {
      var e = t(this).text();
      t(this).text("http:" + e.replace(/^https?:/i, "")), t(this).parent().removeClass("js-https")
    }) : "https" === a && t(".library-url").each(function() {
      var e = t(this).text();
      t(this).text("https:" + e.replace(/^https?:/i, "")), t(this).parent().addClass("js-https")
    }), localforage.setItem("protocal", a, function(t, e) {
      if (t) return console.log(t);
      console.log("saved protocal: ", e)
    })
  })
}(jQuery), $(function() {
  $(".library-url").each(function() {
    var t = $(this).text();
    /\.css$/.test(t) ? $(this).before('<div class="zero-clipboard"><span class="btn-clipboard btn-clipboard-code" title="复制到剪贴板"><i class="fa fa-code"></i> 复制 &lt;link&gt; 标签</span><span class="btn-clipboard btn-clipboard-link" title="复制到剪贴板"><i class="fa fa-link"></i> 复制链接</span></div>') : /\.js$/.test(t) ? $(this).before('<div class="zero-clipboard"><span class="btn-clipboard btn-clipboard-code" title="复制到剪贴板"><i class="fa fa-code"></i> 复制 &lt;script&gt; 标签</span><span class="btn-clipboard btn-clipboard-link" title="复制到剪贴板"><i class="fa fa-link"></i> 复制链接</span></div>') : $(this).before('<div class="zero-clipboard"><span class="btn-clipboard btn-clipboard-link" title="复制到剪贴板"><i class="fa fa-link"></i> 复制链接</span></div>')
  }), $(".btn-clipboard").tooltip({
    container: "body"
  });
  var t = new Clipboard(".btn-clipboard", {
    text: function(t) {
      var e = $(t),
        a = $(t.parentNode.nextElementSibling),
        s = url = a.text();
      return e.hasClass("btn-clipboard-code") && (/\.css$/.test(url) ? s = '<link href="' + url + '" rel="stylesheet">' : /\.js$/.test(url) && (s = '<script src="' + url + '"><\/script>')), s
    }
  });
  t.on("success", function(t) {
    $(t.trigger).attr("title", "已复制！").tooltip("fixTitle").tooltip("show").attr("title", "复制到剪贴板").tooltip("fixTitle"), t.clearSelection()
  }), t.on("error", function(t) {
    var e = /Mac/i.test(navigator.userAgent) ? "⌘" : "Ctrl-",
      a = "Press " + e + "C to copy";
    $(t.trigger).attr("title", a).tooltip("fixTitle").tooltip("show").attr("title", "复制到剪贴板").tooltip("fixTitle")
  })
});